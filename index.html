<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>AI Policy Builder</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    body { font-family: Arial, sans-serif; margin:0; background:#f5f5f5; color:#333; }
    .container { max-width:900px; margin:40px auto; background:white; padding:30px; border-radius:8px; box-shadow:0 0 10px rgba(0,0,0,0.1); }
    h1,h2,h3 { color:#005b96; }
    label { display:block; margin-top:10px; font-weight:bold; }
    input[type="text"], select, textarea { width:100%; padding:8px; margin:4px 0 12px; border:1px solid #ccc; border-radius:4px; }
    textarea { height:80px; }
    button { margin:10px 5px 0 0; padding:10px 18px; background:#005b96; color:white; border:none; border-radius:4px; cursor:pointer; }
    button:hover { background:#003f6d; }
    .skip-btn { background:#999; } .skip-btn:hover { background:#777; }
    .info-icon { cursor:pointer; font-size:1.2em; margin-left:5px; }
    .policy-output { background:#f9f9f9; padding:20px; border:1px dashed #999; border-radius:6px; max-height:600px; overflow-y:auto; }
    .modal { display:none; position:fixed; z-index:1000; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.6); padding-top:60px; }
    .modal-content { background:white; margin:auto; padding:20px; border:1px solid #888; width:80%; max-width:500px; border-radius:8px; position:relative; }
    .close-btn { position:absolute; right:15px; top:10px; font-size:20px; font-weight:bold; cursor:pointer; } .close-btn:hover { color:red; }
    hr { margin:20px 0; } ul { margin-left:20px; }
    table { width:100%; border-collapse:collapse; margin:10px 0; } table, th, td { border:1px solid #ccc; } th, td { padding:8px; text-align:left; }
    #progressContainer { width:100%; background:#e0e0e0; height:12px; border-radius:6px; overflow:hidden; margin-top:20px; }
    #progressBar { width:0%; height:100%; background:#005b96; transition:width 0.3s; }
  </style>
</head>
<body>
  <div class="container">
    <h1>AI Policy Builder</h1>
    <p>Use this wizard to generate a comprehensive AI policy you can paste directly into Word or Google Docs.</p>
    <div id="wizard"></div>
    <div id="progressContainer"><div id="progressBar"></div></div>
  </div>

  <div id="infoModal" class="modal">
    <div class="modal-content">
      <span id="closeModal" class="close-btn">✖️</span>
      <div id="modalText"></div>
    </div>
  </div>

  <script>
    const steps = [
      { id:'company', title:'Company Info', fields:['companyName','industry','jurisdiction','tone'],
        info:`Enter your legal business name, primary industry (e.g., Healthcare / Medical), and governing jurisdiction (e.g., Montreal, Quebec). Choose Formal Legal or Plain Language tone.` },
      { id:'scope', title:'Scope', fields:['scope'],
        info:`Define exactly who (employees, contractors, interns, partners) and what (internal models, third-party AI, environments) this policy covers.` },
      { id:'definitions', title:'Definitions', fields:['includeDefinitions'],
        info:`Include detailed definitions of key terms (AI, ML, LLM, personal data, trade secrets, high-risk AI) and an appendix of examples.` },
      { id:'tools', title:'Approved AI Tools', fields:['approvedToolsList','customTool'],
        info:`Select from the top-20 AI tools list and optionally add any other tools.` },

      // Risk steps immediately after tools
      { id:'riskMode', title:'Risk Classification Mode', fields:['riskMode'],
        info:`
<p><strong>Why risk matters:</strong> Classify AI systems to apply the right level of review, testing, monitoring, and controls.</p>
<table>
  <tr><th>Level</th><th>Definition</th></tr>
  <tr><td><strong>High Risk</strong></td><td>Handles sensitive personal or proprietary data, drives critical decisions (hiring, lending, medical), or is under strict regulatory oversight.</td></tr>
  <tr><td><strong>Medium Risk</strong></td><td>Processes less sensitive data or supports semi-automated decisions with human review.</td></tr>
  <tr><td><strong>Low Risk</strong></td><td>Used for general, non-sensitive tasks (e.g., marketing copy generation with public data).</td></tr>
</table>
<p>Choose <em>Global</em> to apply one level to all tools, or <em>Per-Tool</em> to customize per tool.</p>` },
      { id:'riskClassification', title:'Global Risk Level', fields:['riskClassification'],
        info:`<p>Select the single risk level for all tools:</p>
<ul>
  <li><strong>High</strong> – Full security, bias & ethics review.</li>
  <li><strong>Medium</strong> – Periodic audits & human oversight.</li>
  <li><strong>Low</strong> – Standard monitoring.</li>
</ul>` },
      { id:'riskPerTool', title:'Per-Tool Risk Classification', fields:['riskPerTool'],
        info:`<p>Assign a risk level to each selected tool. Refer to the definitions above:</p>
<ul>
  <li><strong>High Risk:</strong> Sensitive data or critical decisions.</li>
  <li><strong>Medium Risk:</strong> Semi-automated with human review.</li>
  <li><strong>Low Risk:</strong> Non-sensitive, general tasks.</li>
</ul>` },

      { id:'privacy', title:'Data Privacy & Security', fields:['personalData','financialData','tradeSecrets','anonymize','encryption'],
        info:`Specify which data types AI will handle and whether anonymization or encryption is required.` },
      { id:'prohibited', title:'Prohibited Use Cases', fields:['prohibitedUses','customProhibited'],
        info:`Select common prohibited scenarios (e.g., confidential uploads, automated legal/medical advice) and add any custom ones.` },
      { id:'governance', title:'Approved Use & Governance', fields:['requireApproval'],
        info:`Decide if new AI tools require formal risk, security & ethics reviews before approval.` },
      { id:'ip', title:'IP & Trade Secrets', fields:['ipOwnership','protectTradeSecrets'],
        info:`Clarify ownership of AI outputs and trade-secret protection requirements.` },
      { id:'fairness', title:'Fairness & Bias Mitigation', fields:['biasReview','biasAuditFrequency','customBiasRequirements'],
        info:`State bias review requirements, audit frequency, and any additional fairness controls.` },
      { id:'compliance', title:'Compliance & Legal', fields:['laws','customLaws','exportControls','customExport'],
        info:`<p>Select all privacy laws/regulations that apply:</p>
<ul>
  <li><strong>GDPR (EU):</strong> EU personal-data regulation. <a href="https://gdpr.eu" target="_blank">Learn more</a></li>
  <li><strong>CCPA/CPRA (CA):</strong> California consumer privacy rights. <a href="https://oag.ca.gov/privacy/ccpa" target="_blank">Learn more</a></li>
  <li><strong>Quebec Law 25:</strong> Quebec’s private-sector privacy law. <a href="https://www.legisquebec.gouv.qc.ca/en/document/cs/P-39.1" target="_blank">Learn more</a></li>
  <li><strong>PIPEDA (Canada):</strong> Federal private-sector data law. <a href="https://www.priv.gc.ca/en/privacy-topics/privacy-laws-in-canada/the-personal-information-protection-and-electronic-documents-act-pipeda/" target="_blank">Learn more</a></li>
</ul>
<p>Also select any export-control regimes governing cross-border AI transfers.</p>` },
      { id:'transparency', title:'Transparency & Explainability', fields:['publicDisclosure','explainability'],
        info:`Decide if the policy is publicly available and if employees must explain AI-driven decisions.` },
      { id:'training', title:'Training & Awareness', fields:['training','trainingDetails','acknowledgment','ackDetails'],
        info:`Outline mandatory training content and how employees will acknowledge this policy.` },
      { id:'vendorContracts', title:'Vendor & Contract Clauses', fields:['vendorClauses','customVendorClauses'],
        info:`Require security, privacy & ethics clauses in third-party AI agreements.` },
      { id:'dataRetention', title:'Data Retention', fields:['dataRetention','customDataRetention'],
        info:`Specify how long to retain AI data, models & logs.` },
      { id:'logging', title:'Logging & Monitoring', fields:['enableLogging','logRetention','customLogRetention'],
        info:`Enable usage logging and set log retention periods.` },
      { id:'marketing', title:'AI in Marketing & Community Content', fields:['socialChannels','customSocialChannels','creativeTools','customCreativeTools','approvalName','approvalEmail','approvalPhone','approvalSlack','approvalTeams','cautionPersonal','cautionDetails'],
        info:`Define rules for AI-generated social, marketing & community content, including approvals and personal-account cautions.` },
      { id:'incidents', title:'Incident Reporting & Response', fields:['incidentEmail','incidentPhone','incidentSlack','incidentTeams'],
        info:`Provide email, phone, Slack channel & Teams channel for immediate incident reporting.` },
      { id:'review', title:'Review & Updates', fields:['reviewFrequency','responsibleTeam'],
        info:`Choose how often to review this policy and which team owns it.` },
      { id:'signoff', title:'Sign-off & Acknowledgment', fields:['signOff'],
        info:`Decide if employees must formally sign or click-to-acknowledge this policy before using AI.` }
    ];

    const formData = {};
    let currentStep = 0;
    const wizardDiv   = document.getElementById('wizard');
    const progressBar = document.getElementById('progressBar');
    const modal       = document.getElementById('infoModal');
    const modalText   = document.getElementById('modalText');
    const closeModal  = document.getElementById('closeModal');
    function getFieldHTML(f) {
      switch(f) {
        case 'companyName':
          return '<label>Company Name:</label><input type="text" id="companyName">';
        case 'industry':
          return `<label>Industry:</label><select id="industry">
                    <option>Education</option><option>Financial Services</option><option>Healthcare / Medical</option>
                    <option>Insurance</option><option>Legal / Compliance</option><option>Manufacturing</option>
                    <option>Retail / E-commerce</option><option>Technology</option><option>Other</option>
                  </select>`;
        case 'jurisdiction':
          return '<label>Jurisdiction (e.g., Montreal, Quebec):</label><input type="text" id="jurisdiction">';
        case 'tone':
          return `<label>Policy Tone:</label><select id="tone">
                    <option value="formal">Formal Legal</option>
                    <option value="plain">Plain Language</option>
                  </select>`;
        case 'scope':
          return `<label>Applies to:</label><select id="scope">
                    <option value="all">All employees, contractors, interns & partners</option>
                    <option value="employees">Employees only</option>
                  </select>`;
        case 'includeDefinitions':
          return `<label>Include definitions & appendix?</label>
                  <select id="includeDefinitions">
                    <option>Yes</option><option>No</option>
                  </select>`;

        // Approved AI Tools
        case 'approvedToolsList':
          return `<label>Approved AI Tools:</label>
                  <select id="approvedToolsList" multiple size="5">
                    <option>Canva (Magic Studio)</option><option>CapCut</option><option>Character.ai</option>
                    <option>ChatGPT (GPT-4o)</option><option>Claude 3.7 Sonnet</option><option>DeepAI</option>
                    <option>DeepL + DeepL Write</option><option>ElevenLabs</option><option>Google Gemini</option>
                    <option>Grammarly (Gen-AI edition)</option><option>Hugging Face</option><option>Midjourney v7</option>
                    <option>Microsoft Copilot</option><option>Poe (Quora)</option><option>Perplexity AI</option>
                    <option>Quizizz (AI quizzes)</option><option>QuillBot</option><option>Remove.bg</option>
                    <option>Suno</option><option>Zapier (AI Chat + Actions)</option>
                  </select>`;
        case 'customTool':
          return `<label>Other tools:</label>
                  <textarea id="customTool" placeholder="Add additional AI tools…"></textarea>`;

        // Risk Classification Mode
        case 'riskMode':
          return `<label>Risk mode:</label>
                  <select id="riskMode">
                    <option value="global">Global (one level for all)</option>
                    <option value="perTool">Per-Tool (custom per tool)</option>
                  </select>`;

        // Global Risk Level
        case 'riskClassification':
          return `<label>Select global risk level:</label>
                  <select id="riskClassification">
                    <option>High</option><option>Medium</option><option>Low</option>
                  </select>`;

        // Per-Tool Risk Classification
        case 'riskPerTool':
          let html = `
            <table>
              <tr><th>Level</th><th>Definition</th></tr>
              <tr><td><strong>High Risk</strong></td><td>Handles sensitive personal or proprietary data, critical decisions, or strict oversight.</td></tr>
              <tr><td><strong>Medium Risk</strong></td><td>Processes less sensitive data or supports semi-automated decisions with review.</td></tr>
              <tr><td><strong>Low Risk</strong></td><td>Used for general, non-sensitive tasks.</td></tr>
            </table>`;
          const tools = formData.approvedToolsList || [];
          if (!tools.length && !formData.customTool) {
            html += `<p><em>No tools selected—go back and choose at least one.</em></p>`;
            return html;
          }
          tools.forEach((tool,i) => {
            html += `
              <label>Risk for “${tool}”:</label>
              <select id="riskTool_${i}"><option>High</option><option>Medium</option><option>Low</option></select><br>`;
          });
          if (formData.customTool) {
            html += `
              <label>Risk for “${formData.customTool}”:</label>
              <select id="riskTool_custom"><option>High</option><option>Medium</option><option>Low</option></select><br>`;
          }
          return html;

        // Data Privacy & Security
        case 'personalData':
          return `<label><input type="checkbox" id="personalData"> Handle personal data</label>`;
        case 'financialData':
          return `<label><input type="checkbox" id="financialData"> Handle financial data</label>`;
        case 'tradeSecrets':
          return `<label><input type="checkbox" id="tradeSecrets"> Handle trade secrets/IP</label>`;
        case 'anonymize':
          return `<label><input type="checkbox" id="anonymize"> Require anonymization/de-identification</label>`;
        case 'encryption':
          return `<label>Require encryption?</label>
                  <select id="encryption"><option>Yes</option><option>No</option></select>`;

        // Prohibited Use Cases
        case 'prohibitedUses':
          return `<label>Prohibited use cases:</label>
                  <select id="prohibitedUses" multiple>
                    <option>Uploading confidential documents</option>
                    <option>Automated hiring/credit/medical decisions</option>
                    <option>Providing legal advice</option>
                    <option>Generating disallowed content (hate, misinformation)</option>
                  </select>`;
        case 'customProhibited':
          return `<label>Other prohibited uses:</label>
                  <textarea id="customProhibited" placeholder="Describe additional prohibited uses…"></textarea>`;

        // Governance
        case 'requireApproval':
          return `<label>Require review for new tools?</label>
                  <select id="requireApproval"><option>Yes</option><option>No</option></select>`;

        // IP & Trade Secrets
        case 'ipOwnership':
          return `<label>Company-owned AI outputs?</label>
                  <select id="ipOwnership"><option>Yes</option><option>No</option></select>`;
        case 'protectTradeSecrets':
          return `<label>Emphasize trade-secret protection?</label>
                  <select id="protectTradeSecrets"><option>Yes</option><option>No</option></select>`;

        // Fairness & Bias
        case 'biasReview':
          return `<label>Require bias/fairness audit?</label>
                  <select id="biasReview"><option>Yes</option><option>No</option></select>`;
        case 'biasAuditFrequency':
          return `<label>Audit frequency:</label>
                  <select id="biasAuditFrequency"><option>Quarterly</option><option>Semi-annual</option><option>Annual</option></select>`;
        case 'customBiasRequirements':
          return `<label>Additional fairness controls:</label>
                  <textarea id="customBiasRequirements" placeholder="Describe…"></textarea>`;

        // Compliance & Legal
        case 'laws':
          return `<label>Applicable laws:</label>
                  <select id="laws" multiple>
                    <option>GDPR (EU)</option><option>CCPA/CPRA (CA)</option><option>HIPAA (US)</option>
                    <option>Quebec Law 25</option><option>PIPEDA (Canada)</option>
                  </select>`;
        case 'customLaws':
          return `<label>Other laws:</label>
                  <textarea id="customLaws" placeholder="Describe…"></textarea>`;
        case 'exportControls':
          return `<label>Export control regimes:</label>
                  <select id="exportControls" multiple>
                    <option>U.S. EAR/ITAR</option><option>EU Dual-use</option><option>UK Export Controls</option>
                  </select>`;
        case 'customExport':
          return `<label>Other regimes:</label>
                  <textarea id="customExport" placeholder="Describe…"></textarea>`;

        // Transparency & Explainability
        case 'publicDisclosure':
          return `<label>Share policy publicly?</label>
                  <select id="publicDisclosure"><option>Yes</option><option>No</option></select>`;
        case 'explainability':
          return `<label>Require explainability?</label>
                  <select id="explainability"><option>Yes</option><option>No</option></select>`;

        // Training & Awareness
        case 'training':
          return `<label>Mandatory training?</label>
                  <select id="training"><option>Yes</option><option>No</option></select>`;
        case 'trainingDetails':
          return `<label>Training details:</label>
                  <textarea id="trainingDetails" placeholder="Outline training…"></textarea>`;
        case 'acknowledgment':
          return `<label>Require acknowledgment?</label>
                  <select id="acknowledgment"><option>Yes</option><option>No</option></select>`;
        case 'ackDetails':
          return `<label>Acknowledgment instructions:</label>
                  <textarea id="ackDetails" placeholder="Describe…"></textarea>`;

        // Vendor & Contracts
        case 'vendorClauses':
          return `<label>Include vendor clauses?</label>
                  <select id="vendorClauses"><option>Yes</option><option>No</option></select>`;
        case 'customVendorClauses':
          return `<label>Vendor clause details:</label>
                  <textarea id="customVendorClauses" placeholder="Outline clauses…"></textarea>`;

        // Data Retention
        case 'dataRetention':
          return `<label>Retention period:</label>
                  <select id="dataRetention"><option>1 year</option><option>3 years</option><option>5 years</option><option>Indefinite</option></select>`;
        case 'customDataRetention':
          return `<label>Other retention policy:</label>
                  <textarea id="customDataRetention" placeholder="Describe…"></textarea>`;

        // Logging & Monitoring
        case 'enableLogging':
          return `<label><input type="checkbox" id="enableLogging"> Enable usage logging</label>`;
        case 'logRetention':
          return `<label>Log retention:</label>
                  <select id="logRetention"><option>6 months</option><option>1 year</option><option>3 years</option><option>Indefinite</option></select>`;
        case 'customLogRetention':
          return `<label>Other log policy:</label>
                  <textarea id="customLogRetention" placeholder="Describe…"></textarea>`;

        // Marketing & Community
        case 'socialChannels':
          return `<label>Social channels:</label>
                  <select id="socialChannels" multiple>
                    <option>LinkedIn</option><option>Twitter</option><option>Instagram</option>
                    <option>Facebook</option><option>TikTok</option><option>YouTube</option>
                  </select>`;
        case 'customSocialChannels':
          return `<label>Other channels:</label>
                  <textarea id="customSocialChannels" placeholder="…"></textarea>`;
        case 'creativeTools':
          return `<label>Creative AI tools:</label>
                  <select id="creativeTools" multiple>
                    <option>Canva (Magic Studio)</option><option>Midjourney v7</option>
                    <option>DALL·E 3</option><option>Adobe Firefly</option><option>Stable Diffusion</option>
                  </select>`;
        case 'customCreativeTools':
          return `<label>Other creative tools:</label>
                  <textarea id="customCreativeTools" placeholder="…"></textarea>`;

        case 'approvalName':
          return `<label>Approval team/name:</label><input type="text" id="approvalName">`;
        case 'approvalEmail':
          return `<label>Approval email:</label><input type="text" id="approvalEmail">`;
        case 'approvalPhone':
          return `<label>Approval phone:</label><input type="text" id="approvalPhone">`;
        case 'approvalSlack':
          return `<label>Approval Slack channel:</label><input type="text" id="approvalSlack">`;
        case 'approvalTeams':
          return `<label>Approval Teams channel:</label><input type="text" id="approvalTeams">`;

        case 'cautionPersonal':
          return `<label><input type="checkbox" id="cautionPersonal"> Caution about using company data on personal accounts</label>`;
        case 'cautionDetails':
          return `<label>Caution details:</label>
                  <textarea id="cautionDetails" placeholder="…"></textarea>`;

        // Incident Reporting
        case 'incidentEmail':
          return `<label>Incident email:</label><input type="text" id="incidentEmail">`;
        case 'incidentPhone':
          return `<label>Incident phone:</label><input type="text" id="incidentPhone">`;
        case 'incidentSlack':
          return `<label>Incident Slack channel:</label><input type="text" id="incidentSlack">`;
        case 'incidentTeams':
          return `<label>Incident Teams channel:</label><input type="text" id="incidentTeams">`;

        // Review & Sign-off
        case 'reviewFrequency':
          return `<label>Review frequency:</label>
                  <select id="reviewFrequency"><option>Annually</option><option>Semi-annual</option><option>As needed</option></select>`;
        case 'responsibleTeam':
          return `<label>Responsible team:</label><input type="text" id="responsibleTeam">`;
        case 'signOff':
          return `<label>Require sign-off?</label>
                  <select id="signOff"><option>Yes</option><option>No</option></select>`;

        default:
          return '';
      }
    }
    function saveStepData() {
      steps[currentStep].fields.forEach(f => {
        if (f.startsWith('riskTool_')) return;
        const el = document.getElementById(f);
        if (!el) return;
        if (el.type === 'checkbox') formData[f] = el.checked;
        else if (el.multiple) formData[f] = [...el.selectedOptions].map(o => o.value);
        else formData[f] = el.value;
      });
      if (steps[currentStep].id === 'riskPerTool') {
        formData.toolRisks = {};
        (formData.approvedToolsList || []).forEach((tool,i) => {
          formData.toolRisks[tool] = document.getElementById(`riskTool_${i}`).value;
        });
        if (formData.customTool) {
          formData.toolRisks[formData.customTool] = document.getElementById('riskTool_custom').value;
        }
      }
    }

    function prevStep()  { currentStep--; renderStep(); }
    function nextStep()  { saveStepData(); currentStep++; renderStep(); }
    function skipStep()  { currentStep++; renderStep(); }

    function showInfo(txt) {
      modalText.innerHTML = txt;
      modal.style.display = 'block';
    }
    closeModal.onclick = () => modal.style.display = 'none';
    window.onclick = e => { if (e.target === modal) modal.style.display = 'none'; };

    function renderStep() {
      if (currentStep >= steps.length) return renderFinal();
      const s = steps[currentStep];
      if (s.id==='riskPerTool' && formData.riskMode!=='perTool') { currentStep++; return renderStep(); }
      if (s.id==='riskClassification' && formData.riskMode==='perTool') { currentStep++; return renderStep(); }

      let html = `<h2>${s.title} <span class="info-icon" onclick="showInfo(\`${s.info}\`)">ℹ️</span></h2>`;
      s.fields.forEach(f => html += getFieldHTML(f));
      html += `<button onclick="prevStep()">Previous</button>
               <button onclick="nextStep()">Next</button>
               <button class="skip-btn" onclick="skipStep()">Skip</button>`;
      wizardDiv.innerHTML = html;
      progressBar.style.width = Math.round((currentStep/steps.length)*100) + '%';
    }
    function heading(n,t){ return `<h3>${n}. ${t}</h3>`; }

    // 1. Introduction & Purpose
    function sectionIntro() {
      const c = formData.companyName||'[Company Name]';
      const j = formData.jurisdiction||'[Jurisdiction]';
      return heading(1,'Introduction & Purpose')+`
<p>This policy establishes principles, rules, and controls for safe, ethical, and compliant use of AI across <strong>${c}</strong>. Objectives:</p>
<ul>
  <li>Safeguard customer & employee data;</li>
  <li>Protect trade secrets & IP;</li>
  <li>Prevent bias & discrimination;</li>
  <li>Uphold all applicable laws & standards;</li>
  <li>Maintain trust of stakeholders;</li>
  <li>Operate under the laws of ${j}.</li>
</ul><hr>`;
    }

    // 2. Scope
    function sectionScope() {
      const who = formData.scope==='employees'? 'All employees.' : 'Employees, contractors, interns & partners.';
      return heading(2,'Scope')+`
<ul>
  <li><strong>Who:</strong> ${who}</li>
  <li><strong>What:</strong> Internal models, third-party AI, generative/predictive systems.</li>
  <li><strong>Where/When:</strong> On-premises, remote, mobile—any device.</li>
</ul><hr>`;
    }

    // 3. Definitions
    function sectionDefinitions() {
      if(formData.includeDefinitions!=='Yes') return '';
      return heading(3,'Definitions')+`
<table>
  <tr><th>Term</th><th>Definition</th></tr>
  <tr><td><strong>AI</strong></td><td>Systems performing tasks requiring human-like intelligence.</td></tr>
  <tr><td><strong>ML</strong></td><td>Algorithms learning patterns from data to predict or decide.</td></tr>
  <tr><td><strong>LLM</strong></td><td>Large Language Models trained on massive text datasets.</td></tr>
  <tr><td><strong>Personal Data</strong></td><td>Information identifying a person (GDPR/CCPA/Law 25).</td></tr>
  <tr><td><strong>Trade Secret</strong></td><td>Non-public info with competitive value.</td></tr>
  <tr><td><strong>High-Risk AI</strong></td><td>AI whose outputs significantly impact people or operations.</td></tr>
</table><hr>`;
    }

    // 4. Approved AI Tools
    function sectionTools() {
      const tools = formData.approvedToolsList||[];
      let list = tools.map(t=>`<li>${t}</li>`).join('');
      if(formData.customTool) list+=`<li>${formData.customTool}</li>`;
      return heading(4,'Approved AI Tools')+`<ul>${list}</ul><hr>`;
    }

    // 5. Data Privacy & Security
    function sectionPrivacy() {
      const bullets=[];
      if(formData.personalData) bullets.push('Never share personal data without approval.');
      if(formData.tradeSecrets) bullets.push('Protect trade secrets in secure environments.');
      if(formData.financialData) bullets.push('Handle financial data under compliance.');
      if(formData.anonymize) bullets.push('Anonymize data before use.');
      if(formData.encryption) bullets.push('Encrypt AI data at rest/in transit.');
      if(!bullets.length) return '';
      return heading(5,'Data Privacy & Security')+`<ol>${bullets.map(b=>`<li>${b}</li>`).join('')}</ol><hr>`;
    }

    // 6. Prohibited Use Cases
    function sectionProhibited() {
      const uses=formData.prohibitedUses||[];
      let list=uses.map(u=>`<li>${u}</li>`).join('');
      if(formData.customProhibited) list+=`<li>${formData.customProhibited}</li>`;
      return heading(6,'Prohibited Use Cases')+`<ul>${list}</ul><hr>`;
    }

    // 7. Approved Use & Governance
    function sectionGovernance() {
      return heading(7,'Approved Use & Governance')+`
<p>${formData.requireApproval==='Yes'
  ? 'All new AI tools require risk, security & ethics reviews before approval.'
  : 'No formal approval workflow defined.'}</p><hr>`;
    }

    // 8. IP & Trade Secrets
    function sectionIP() {
      return heading(8,'Intellectual Property & Trade Secrets')+`
<p>${formData.ipOwnership==='Yes'
  ? 'AI outputs using company data are company-owned IP.'
  : 'Ownership follows project agreements.'}</p>
<p>${formData.protectTradeSecrets==='Yes'
  ? 'Employees must not disclose trade secrets via AI.'
  : 'Standard confidentiality applies.'}</p><hr>`;
    }

    // 9. Fairness & Bias Mitigation
    function sectionBias() {
      let out=`<p>${formData.biasReview==='Yes'
        ? 'High-risk AI requires a Bias & Fairness Review before deployment.'
        : 'No mandatory bias review.'}</p>`;
      if(formData.biasAuditFrequency) out+=`<p>Audit frequency: <strong>${formData.biasAuditFrequency}</strong>.</p>`;
      if(formData.customBiasRequirements) out+=`<p>${formData.customBiasRequirements}</p>`;
      return heading(9,'Fairness & Bias Mitigation')+out+'<hr>';
    }

    // 10. Compliance & Legal
    function lawSummary(law) {
      const map={
        GDPR: {txt:'EU data-protection regulation.',url:'https://gdpr.eu'},
        CCPA:{txt:'California privacy law.',url:'https://oag.ca.gov/privacy/ccpa'},
        'Quebec Law 25':{txt:'Quebec private-sector privacy law.',url:'https://www.legisquebec.gouv.qc.ca/en/document/cs/P-39.1'},
        PIPEDA:{txt:'Canadian federal privacy law.',url:'https://www.priv.gc.ca/en/privacy-topics/privacy-laws-in-canada/the-personal-information-protection-and-electronic-documents-act-pipeda/'},
        HIPAA:{txt:'US medical privacy law.',url:'https://www.hhs.gov/hipaa'}
      };
      const e=map[law];
      return e?`<li><strong>${law}:</strong> ${e.txt} <a href="${e.url}" target="_blank">Learn more</a></li>`:'';
    }
    function sectionCompliance() {
      const laws=formData.laws||[];
      let items=laws.map(lawSummary).join('');
      if(formData.customLaws) items+=`<li>${formData.customLaws}</li>`;
      const ex=(formData.exportControls||[]).map(x=>`<li>${x}</li>`).join('');
      if(formData.customExport) items+=`<li>${formData.customExport}</li>`;
      return heading(10,'Compliance & Legal')+`
<ul>
  ${items}
  ${ex?`<li><strong>Export Controls:</strong><ul>${ex}</ul></li>`:''}
  <li>Supplements Info Security, Code of Conduct & IP policies.</li>
</ul><hr>`;
    }

    // 11. Transparency & Explainability
    function sectionTransparency() {
      return heading(11,'Transparency & Explainability')+`
<p>${formData.publicDisclosure==='Yes'
  ? 'Policy and AI usage details are publicly disclosed.'
  : 'No public disclosure.'}</p>
<p>${formData.explainability==='Yes'
  ? 'Employees must explain AI-driven decisions upon request.'
  : 'No explainability requirement.'}</p><hr>`;
    }

    // 12. Training & Awareness
    function sectionTraining() {
      let out=`<p>${formData.training==='Yes'
        ? 'Mandatory onboarding on AI ethics, privacy & this policy.'
        : 'Training recommended but not required.'}</p>`;
      if(formData.trainingDetails) out+=`<p>${formData.trainingDetails}</p>`;
      out+=`<p>${formData.acknowledgment==='Yes'
        ? 'Employees must acknowledge via HR portal.'
        : 'No acknowledgment required.'}</p>`;
      if(formData.ackDetails) out+=`<p>${formData.ackDetails}</p>`;
      return heading(12,'Training & Awareness')+out+'<hr>';
    }

    // 13. Vendor & Contract Clauses
    function sectionVendorContracts() {
      return heading(13,'Vendor & Contract Clauses')+`
<p>${formData.vendorClauses==='Yes'
  ? 'All AI vendors must sign security, privacy & ethics clauses.'
  : 'No vendor clause requirement.'}</p>
<p>${formData.customVendorClauses||''}</p><hr>`;
    }

    // 14. Data Retention
    function sectionDataRetention() {
      const dr=formData.dataRetention||'Not specified';
      return heading(14,'Data Retention')+`
<p>AI data & logs retained for <strong>${dr}</strong>.</p>
<p>${formData.customDataRetention||''}</p><hr>`;
    }

    // 15. Logging & Monitoring
    function sectionLogging() {
      const en=formData.enableLogging?'Yes':'No';
      const lr=formData.logRetention||'Not specified';
      return heading(15,'Logging & Monitoring')+`
<p>Logging enabled: <strong>${en}</strong>.</p>
<p>Log retention: <strong>${lr}</strong>.</p>
<p>${formData.customLogRetention||''}</p><hr>`;
    }

    // 16. AI in Marketing & Community Content
    function sectionMarketing() {
      const chans=(formData.socialChannels||[]).join(', ')||'None';
      const cch=formData.customSocialChannels?`, ${formData.customSocialChannels}`:'';
      const tools=(formData.creativeTools||[]).join(', ')||'None';
      const ct=formData.customCreativeTools?`, ${formData.customCreativeTools}`:'';
      const approval=[
        formData.approvalName&&`Name/Team: ${formData.approvalName}`,
        formData.approvalEmail&&`Email: ${formData.approvalEmail}`,
        formData.approvalPhone&&`Phone: ${formData.approvalPhone}`,
        formData.approvalSlack&&`Slack: ${formData.approvalSlack}`,
        formData.approvalTeams&&`Teams: ${formData.approvalTeams}`
      ].filter(Boolean).join('; ')||'None specified';
      return heading(16,'AI in Marketing & Community Content')+`
<p><strong>Social Channels:</strong> ${chans}${cch}</p>
<p><strong>Creative Tools:</strong> ${tools}${ct}</p>
<p><strong>Approval Workflow:</strong> ${approval}</p>
<p><strong>Caution:</strong> ${formData.cautionPersonal
  ? `Be careful using company data on personal accounts: ${formData.cautionDetails}`
  : 'No special caution.'}</p>
<ul>
  <li>Follow Brand Guidelines.</li>
  <li>Pre-publish review if required.</li>
  <li>Use anonymized community content only.</li>
  <li>Disclose AI usage with “#AIGenerated”.</li>
</ul><hr>`;
    }

    // 17. Risk Classification & Controls
    function sectionRisk() {
      if(formData.riskMode==='perTool') {
        let rows='';
        for(const [tool,lvl] of Object.entries(formData.toolRisks||{})) {
          rows+=`<tr><td>${tool}</td><td>${lvl}</td><td>${
            lvl==='High'   ? 'Full security, bias & ethics review' :
            lvl==='Medium' ? 'Quarterly audits & human oversight' :
                              'Standard monitoring'
          }</td></tr>`;
        }
        return heading(17,'Risk Classification & Controls')+`
<p>Per-tool risk levels and controls:</p>
<table>
  <tr><th>Tool</th><th>Risk Level</th><th>Controls</th></tr>
  ${rows}
</table><hr>`;
      } else {
        const lvl=formData.riskClassification||'Not specified';
        return heading(17,'Global Risk Classification')+`
<p>Global risk level: <strong>${lvl}</strong>.</p>
<p>${lvl==='High'
  ? 'Full security, bias & ethics reviews for all tools.'
  : lvl==='Medium'
    ? 'Quarterly audits & human oversight.'
    : 'Standard monitoring.'}</p><hr>`;
      }
    }

    // 18. Incident Reporting & Response
    function sectionIncidents() {
      const parts=[];
      if(formData.incidentEmail) parts.push(`Email: ${formData.incidentEmail}`);
      if(formData.incidentPhone) parts.push(`Phone: ${formData.incidentPhone}`);
      if(formData.incidentSlack) parts.push(`Slack: ${formData.incidentSlack}`);
      if(formData.incidentTeams) parts.push(`Teams: ${formData.incidentTeams}`);
      return heading(18,'Incident Reporting & Response')+`
<p>Report AI incidents via ${parts.join(', ')}.</p>
<ul>
  <li>Triage by Security & Governance lead.</li>
  <li>Remediation plan within 10 business days.</li>
  <li>Notify regulators/customers per obligations.</li>
</ul><hr>`;
    }

    // 19. Review & Updates
    function sectionReview() {
      return heading(19,'Review & Updates')+`
<ul>
  <li>Frequency: <strong>${formData.reviewFrequency}</strong>.</li>
  <li>Responsible Team: <strong>${formData.responsibleTeam}</strong>.</li>
</ul><hr>`;
    }

    // 20. Sign-off & Acknowledgment
    function sectionSignoff() {
      return heading(20,'Sign-off & Acknowledgment')+`
<p>${formData.signOff==='Yes'
  ? 'All personnel must sign or acknowledge this policy before using AI tools.'
  : 'No sign-off required.'}</p><hr>`;
    }

    // Render final policy & copy
    function renderFinal() {
      let out='';
      out+=sectionIntro();
      out+=sectionScope();
      out+=sectionDefinitions();
      out+=sectionTools();
      out+=sectionPrivacy();
      out+=sectionProhibited();
      out+=sectionGovernance();
      out+=sectionIP();
      out+=sectionBias();
      out+=sectionCompliance();
      out+=sectionTransparency();
      out+=sectionTraining();
      out+=sectionVendorContracts();
      out+=sectionDataRetention();
      out+=sectionLogging();
      out+=sectionMarketing();
      out+=sectionRisk();
      out+=sectionIncidents();
      out+=sectionReview();
      out+=sectionSignoff();
      out+=`<p><em>Approved by: ______________________  Date: ___________  Version: 1.0</em></p>
            <p><em>Generated with AI Policy Builder. Review with legal & compliance teams. No liability assumed.</em></p>`;
      wizardDiv.innerHTML=`<h2>Preview & Copy</h2>
        <div class="policy-output">${out}</div>
        <button onclick="copyRichText()">Copy to Clipboard</button>`;
    }

    function copyRichText() {
      const div=document.querySelector('.policy-output');
      const range=document.createRange();
      range.selectNode(div);
      window.getSelection().removeAllRanges();
      window.getSelection().addRange(range);
      document.execCommand('copy');
      window.getSelection().removeAllRanges();
      alert('Policy copied to clipboard!');
    }

    // Start wizard
    renderStep();
  </script>
</body>
</html>
