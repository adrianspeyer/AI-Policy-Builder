<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>AI Policy Builder</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    body { font-family: Arial, sans-serif; margin:0; background:#f5f5f5; color:#333; }
    .container { max-width:900px; margin:40px auto; background:white; padding:30px; border-radius:8px; box-shadow:0 0 10px rgba(0,0,0,0.1); }
    h1,h2,h3 { color:#005b96; }
    label { display:block; margin-top:10px; font-weight:bold; }
    input[type="text"], select, textarea { width:100%; padding:8px; margin:4px 0 12px; border:1px solid #ccc; border-radius:4px; }
    textarea { height:80px; }
    button { margin:10px 5px 0 0; padding:10px 18px; background:#005b96; color:white; border:none; border-radius:4px; cursor:pointer; }
    button:hover { background:#003f6d; }
    .skip-btn { background:#999; } .skip-btn:hover { background:#777; }
    .info-icon { cursor:pointer; font-size:1.2em; margin-left:5px; }
    .policy-output { background:#f9f9f9; padding:20px; border:1px dashed #999; border-radius:6px; max-height:600px; overflow-y:auto; }
    .modal { display:none; position:fixed; z-index:1000; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.6); padding-top:60px; }
    .modal-content { background:white; margin:auto; padding:20px; border:1px solid #888; width:80%; max-width:500px; border-radius:8px; position:relative; }
    .close-btn { position:absolute; right:15px; top:10px; font-size:20px; font-weight:bold; cursor:pointer; }
    .close-btn:hover { color:red; }
    hr { margin:20px 0; }
    ul { margin-left:20px; }
    table { width:100%; border-collapse:collapse; margin:10px 0; }
    table, th, td { border:1px solid #ccc; }
    th, td { padding:8px; text-align:left; }

    /* Progress bar */
    #progressContainer { width:100%; background:#e0e0e0; height:12px; border-radius:6px; overflow:hidden; margin-top:20px; }
    #progressBar { width:0%; height:100%; background:#005b96; transition:width 0.3s; }
  </style>
</head>
<body>
  <div class="container">
    <h1>AI Policy Builder</h1>
    <p>Use this wizard to generate a fully robust AI policy you can paste into Word or Docs.</p>
    <div id="wizard"></div>
    <div id="progressContainer"><div id="progressBar"></div></div>
  </div>

  <div id="infoModal" class="modal">
    <div class="modal-content">
      <span id="closeModal" class="close-btn">✖️</span>
      <div id="modalText"></div>
    </div>
  </div>

  <script>
    const steps = [
      { id:'company', title:'Company Info', info:'Name, industry, jurisdiction (e.g., Montreal, Quebec) & tone.', fields:['companyName','industry','jurisdiction','tone'] },
      { id:'scope', title:'Scope', info:'Who, what, where this applies to.', fields:['scope'] },
      { id:'definitions', title:'Definitions', info:'Include expanded definitions & appendix?', fields:['includeDefinitions'] },
      { id:'tools', title:'Approved AI Tools', info:'Select from top 20 AI tools + Other.', fields:['approvedToolsList','customTool'] },
      { id:'privacy', title:'Data Privacy & Security', info:'Personal, financial, trade secret data, anonymization, encryption.', fields:['personalData','financialData','tradeSecrets','anonymize','encryption'] },
      { id:'prohibited', title:'Prohibited Use Cases', info:'Select prohibited cases + free-text.', fields:['prohibitedUses','customProhibited'] },
      { id:'governance', title:'Approved Use & Governance', info:'Ethics, security & privacy review requirements.', fields:['requireApproval'] },
      { id:'ip', title:'IP & Trade Secrets', info:'Ownership & confidentiality details.', fields:['ipOwnership','protectTradeSecrets'] },
      { id:'fairness', title:'Fairness & Bias Mitigation', info:'Bias reviews & audits.', fields:['biasReview','biasAuditFrequency'] },
      { id:'compliance', title:'Compliance & Legal', info:'Select laws, export controls, code refs.', fields:['laws','customLaws','exportControls','customExport'] },
      { id:'transparency', title:'Transparency & Explainability', info:'Public disclosure & explanations.', fields:['publicDisclosure','explainability'] },
      { id:'training', title:'Training & Awareness', info:'Curriculum & acknowledgment.', fields:['training','acknowledgment'] },
      { id:'vendorContracts', title:'Vendor Contracts', info:'Contract clause requirements.', fields:['vendorClauses','customVendorClauses'] },
      { id:'dataRetention', title:'Data Retention', info:'How long to keep AI data & logs.', fields:['dataRetention','customDataRetention'] },
      { id:'logging', title:'Logging & Monitoring', info:'Usage logging & retention.', fields:['enableLogging','logRetention','customLogRetention'] },
      { id:'riskClass', title:'Risk Classification', info:'High, medium or low risk systems.', fields:['riskClassification','customRiskClassification'] },
      { id:'incidents', title:'Incident Reporting', info:'Contact details for incident reports.', fields:['incidentEmail','incidentPhone','incidentSlack','incidentTeams'] },
      { id:'review', title:'Review & Updates', info:'Frequency & responsible team.', fields:['reviewFrequency','responsibleTeam'] },
      { id:'signoff', title:'Sign-off & Acknowledgment', info:'Require signatures?', fields:['signOff'] }
    ];
    const formData = {};
    let currentStep = 0;

    const wizardDiv = document.getElementById('wizard');
    const progressBar = document.getElementById('progressBar');
    const modal = document.getElementById('infoModal');
    const modalText = document.getElementById('modalText');
    const closeModal = document.getElementById('closeModal');
    function getFieldHTML(f) {
      switch(f) {
        case 'companyName':
          return '<label>Company Name:</label><input type="text" id="companyName" placeholder="Acme Corp">';
        case 'industry':
          return `<label>Industry:</label><select id="industry">
                    <option value="">-- Select --</option>
                    <option>Education</option><option>Financial Services</option><option>Healthcare / Medical</option>
                    <option>Insurance</option><option>Legal / Compliance</option><option>Manufacturing</option>
                    <option>Retail / E-commerce</option><option>Technology</option><option>Other</option>
                  </select>`;
        case 'jurisdiction':
          return '<label>Jurisdiction (e.g., Montreal, Quebec):</label><input type="text" id="jurisdiction">';
        case 'tone':
          return `<label>Policy Tone:</label><select id="tone">
                    <option value="formal">Formal Legal</option>
                    <option value="plain">Plain Language</option>
                  </select>`;
        case 'scope':
          return `<label>Who does this apply to?</label><select id="scope">
                    <option value="all">All employees, contractors, interns & partners</option>
                    <option value="employees">Employees only</option>
                  </select>`;
        case 'includeDefinitions':
          return `<label>Include definitions & appendix?</label>
                    <select id="includeDefinitions"><option value="yes">Yes</option><option value="no">No</option></select>`;
        case 'approvedToolsList':
          return `<label>Approved AI Tools (multi-select):</label>
                    <select id="approvedToolsList" multiple>
                      <option>Canva (Magic Studio)</option>
                      <option>CapCut</option>
                      <option>Character.ai</option>
                      <option>ChatGPT (GPT-4o)</option>
                      <option>Claude 3.7 Sonnet</option>
                      <option>DeepAI</option>
                      <option>DeepL + DeepL Write</option>
                      <option>ElevenLabs</option>
                      <option>Google Gemini</option>
                      <option>Grammarly (Gen-AI)</option>
                      <option>Hugging Face</option>
                      <option>Midjourney v7</option>
                      <option>Microsoft Copilot</option>
                      <option>Poe (Quora)</option>
                      <option>Perplexity AI</option>
                      <option>Quizizz (AI quizzes)</option>
                      <option>QuillBot</option>
                      <option>Remove.bg</option>
                      <option>Suno</option>
                      <option>Zapier (AI Chat+Actions)</option>
                    </select>
                    <label>Other tools (free text):</label><textarea id="customTool"></textarea>`;
        case 'personalData':
          return `<label><input type="checkbox" id="personalData"> Handle customer personal data</label>`;
        case 'financialData':
          return `<label><input type="checkbox" id="financialData"> Handle financial data</label>`;
        case 'tradeSecrets':
          return `<label><input type="checkbox" id="tradeSecrets"> Handle trade secrets/IP</label>`;
        case 'anonymize':
          return `<label><input type="checkbox" id="anonymize"> Require data anonymization/de-identification</label>`;
        case 'encryption':
          return `<label>Require encryption & secure environments?</label>
                    <select id="encryption"><option>Yes</option><option>No</option></select>`;
        case 'prohibitedUses':
          return `<label>Prohibited Use Cases:</label>
                    <select id="prohibitedUses" multiple>
                      <option>Uploading confidential documents</option>
                      <option>Automated hiring/credit/medical decisions</option>
                      <option>Providing legal advice</option>
                      <option>Generating hate/disinformation/malware</option>
                    </select>
                    <label>Other prohibited uses:</label><textarea id="customProhibited"></textarea>`;
        case 'requireApproval':
          return `<label>Require ethics & security review for new tools?</label>
                    <select id="requireApproval"><option>Yes</option><option>No</option></select>`;
        case 'ipOwnership':
          return `<label>Are AI outputs company-owned IP?</label>
                    <select id="ipOwnership"><option>Yes</option><option>No</option></select>`;
        case 'protectTradeSecrets':
          return `<label>Emphasize trade-secret protection?</label>
                    <select id="protectTradeSecrets"><option>Yes</option><option>No</option></select>`;
        case 'biasReview':
          return `<label>Require bias/fairness audits?</label>
                    <select id="biasReview"><option>Yes</option><option>No</option></select>`;
        case 'biasAuditFrequency':
          return `<label>Bias audit frequency:</label>
                    <select id="biasAuditFrequency">
                      <option>Quarterly</option><option>Semi-annual</option><option>Annual</option>
                    </select>`;
        case 'laws':
          return `<label>Applicable laws:</label>
                    <select id="laws" multiple>
                      <option>GDPR</option><option>CCPA</option><option>HIPAA</option>
                      <option>Quebec Law 25</option><option>PIPEDA</option>
                    </select>
                    <label>Other laws:</label><textarea id="customLaws"></textarea>`;
        case 'exportControls':
          return `<label>Export Control Regimes:</label>
                    <select id="exportControls" multiple>
                      <option>U.S. EAR/ITAR</option>
                      <option>EU Dual-use Regulation</option>
                      <option>UK Export Controls</option>
                    </select>
                    <label>Other regimes:</label><textarea id="customExport"></textarea>`;
        case 'publicDisclosure':
          return `<label>Share policy publicly?</label>
                    <select id="publicDisclosure"><option>Yes</option><option>No</option></select>`;
        case 'explainability':
          return `<label>Require explainability?</label>
                    <select id="explainability"><option>Yes</option><option>No</option></select>`;
        case 'training':
          return `<label>Mandatory training?</label>
                    <select id="training"><option>Yes</option><option>No</option></select>`;
        case 'acknowledgment':
          return `<label>Require policy acknowledgment?</label>
                    <select id="acknowledgment"><option>Yes</option><option>No</option></select>`;
        case 'vendorClauses':
          return `<label>Include contract clauses for vendors?</label>
                    <select id="vendorClauses"><option>Yes</option><option>No</option></select>
                    <label>Special vendor requirements:</label><textarea id="customVendorClauses"></textarea>`;
        case 'dataRetention':
          return `<label>Data retention period:</label>
                    <select id="dataRetention">
                      <option>1 year</option><option>3 years</option><option>5 years</option><option>Indefinite</option>
                    </select>
                    <label>Other retention policy:</label><textarea id="customDataRetention"></textarea>`;
        case 'enableLogging':
          return `<label><input type="checkbox" id="enableLogging"> Enable usage logging for all AI tools</label>`;
        case 'logRetention':
          return `<label>Log retention period:</label>
                    <select id="logRetention">
                      <option>6 months</option><option>1 year</option><option>3 years</option><option>Indefinite</option>
                    </select>
                    <label>Other log retention:</label><textarea id="customLogRetention"></textarea>`;
        case 'riskClassification':
          return `<label>Risk classification:</label>
                    <select id="riskClassification">
                      <option>High</option><option>Medium</option><option>Low</option>
                    </select>
                    <label>Other classification details:</label><textarea id="customRiskClassification"></textarea>`;
        case 'incidentEmail':
          return `<label>Incident report email:</label><input type="text" id="incidentEmail" placeholder="ai-incidents@company.com">`;
        case 'incidentPhone':
          return `<label>Incident hotline phone:</label><input type="text" id="incidentPhone" placeholder="1-800-123-4567">`;
        case 'incidentSlack':
          return `<label>Slack channel/webhook:</label><input type="text" id="incidentSlack" placeholder="#ai-incidents">`;
        case 'incidentTeams':
          return `<label>Teams channel/webhook:</label><input type="text" id="incidentTeams" placeholder="AI Incidents Channel">`;
        case 'reviewFrequency':
          return `<label>Policy review frequency:</label>
                    <select id="reviewFrequency"><option>Annually</option><option>Semi-annually</option><option>As needed</option></select>`;
        case 'responsibleTeam':
          return `<label>Responsible review team:</label><input type="text" id="responsibleTeam">`;
        case 'signOff':
          return `<label>Require sign-off?</label>
                    <select id="signOff"><option>Yes</option><option>No</option></select>`;
        default:
          return '';
      }
    }

    function saveStepData() {
      steps[currentStep].fields.forEach(f => {
        const el = document.getElementById(f);
        if (!el) return;
        if (el.type === 'checkbox') formData[f] = el.checked;
        else if (el.multiple) formData[f] = [...el.selectedOptions].map(o=>o.value);
        else formData[f] = el.value;
      });
    }

    function nextStep() { saveStepData(); currentStep++; renderStep(); }
    function prevStep() { currentStep--; renderStep(); }
    function skipStep() { currentStep++; renderStep(); }

    function showInfo(txt) { modalText.innerHTML = txt; modal.style.display='block'; }
    closeModal.onclick = ()=> modal.style.display='none';
    window.onclick = e=> { if(e.target===modal) modal.style.display='none'; };

    function renderStep() {
      if (currentStep >= steps.length) return renderFinal();
      const s = steps[currentStep];
      let html = `<h2>${s.title} <span class="info-icon" onclick="showInfo('${s.info}')">ℹ️</span></h2>`;
      s.fields.forEach(f => html += getFieldHTML(f));
      html += `<button onclick="prevStep()">Previous</button>
               <button onclick="nextStep()">Next</button>
               <button class="skip-btn" onclick="skipStep()">Skip</button>`;
      wizardDiv.innerHTML = html;
      // update progress bar
      const pct = Math.round((currentStep / steps.length) * 100);
      progressBar.style.width = pct + '%';
    }
    function heading(num, title) {
      return `<h3>${num}. ${title}</h3>`;
    }

    function sectionIntro() {
      const c = formData.companyName, j = formData.jurisdiction;
      return heading(1,'Introduction & Purpose') + `
<p>This policy establishes the principles, rules, and controls for safe, ethical, and legally compliant use of AI across <strong>${c}</strong>. Our objectives:</p>
<ul>
  <li>Safeguard customer & employee data;</li>
  <li>Protect trade secrets & IP;</li>
  <li>Prevent bias & discrimination;</li>
  <li>Uphold all applicable laws & standards;</li>
  <li>Maintain trust of stakeholders;</li>
  <li>Ensure deployment under the laws of ${j}.</li>
</ul><hr>`;
    }

    function sectionScope() {
      const who = formData.scope==='employees'
        ? 'All employees.'
        : 'Employees, contractors, interns & partners.';
      return heading(2,'Scope') + `
<ul>
  <li><strong>Who:</strong> ${who}</li>
  <li><strong>What:</strong> Internally built AI models, third-party services (ChatGPT, Copilot…), generative/predictive systems.</li>
  <li><strong>Where/When:</strong> On-premises, remote, mobile—any device.</li>
</ul><hr>`;
    }

    function sectionDefinitions() {
      if (formData.includeDefinitions!=='yes') return '';
      return heading(3,'Definitions') + `
<table>
  <tr><th>Term</th><th>Definition</th></tr>
  <tr><td><strong>AI</strong></td><td>Systems that perform tasks requiring human‐like intelligence.</td></tr>
  <tr><td><strong>ML</strong></td><td>Algorithms that learn patterns from data to make predictions.</td></tr>
  <tr><td><strong>LLM</strong></td><td>Large Language Models (e.g., GPT-4) for text generation.</td></tr>
  <tr><td><strong>Personal Data</strong></td><td>Info that identifies a person (GDPR/CCPA/Law 25).</td></tr>
  <tr><td><strong>Trade Secret</strong></td><td>Non-public business info offering competitive edge.</td></tr>
  <tr><td><strong>High-Risk AI</strong></td><td>AI affecting critical outcomes (hiring, lending, medical).</td></tr>
</table><hr>`;
    }

    function sectionTools() {
      const tools = formData.approvedToolsList || [];
      if (!tools.length && !formData.customTool) return '';
      let list = '';
      tools.forEach((t,i)=> list += `<li>${i+1}. ${t}</li>`);
      if (formData.customTool) list += `<li>${tools.length+1}. ${formData.customTool}</li>`;
      return heading(4,'Approved AI Tools') + `
<p>The following AI tools are approved for use:</p>
<ol>${list}</ol><hr>`;
    }

    function sectionPrivacy() {
      const bullets = [];
      if (formData.personalData) bullets.push('Personal data is never shared with public AI systems without approval.');
      if (formData.tradeSecrets) bullets.push('Trade secrets are stored in secure, access-controlled environments.');
      if (formData.financialData) bullets.push('Financial data is handled per compliance protocols.');
      if (formData.anonymize) bullets.push('Data for AI training/testing must be de-identified or anonymized.');
      if (formData.encryption) bullets.push('All AI data at rest and in transit is encrypted.');
      if (!bullets.length) return '';
      return heading(5,'Data Privacy & Security') + `
<ol>${bullets.map(b=>`<li>${b}</li>`).join('')}</ol><hr>`;
    }

    function sectionProhibited() {
      const pu = formData.prohibitedUses||[];
      if (!pu.length && !formData.customProhibited) return '';
      let list = pu.map(u=>`<li>${u}</li>`).join('');
      if (formData.customProhibited) list += `<li>${formData.customProhibited}</li>`;
      return heading(6,'Prohibited Use Cases') + `<ul>${list}</ul><hr>`;
    }

    function sectionGovernance() {
      const req = formData.requireApproval==='Yes';
      return heading(7,'Approved Use & Governance') + `
<p>${req
  ? 'All new AI tools must pass an AI Risk Assessment, Security & Privacy Review, and Ethics Review before committee sign-off.'
  : 'No formal tool onboarding process is defined at this time.'}</p><hr>`;
    }

    function sectionIP() {
      const own = formData.ipOwnership==='Yes';
      const prot = formData.protectTradeSecrets==='Yes';
      return heading(8,'Intellectual Property & Trade Secrets') + `
<p>${own
  ? 'All AI outputs using company data are considered company-owned intellectual property.'
  : 'Ownership of AI outputs is determined per individual project agreements.'}</p>
<p>${prot
  ? 'Employees must not disclose any trade-secret information via AI tools.'
  : 'Standard confidentiality agreements remain in force for trade secrets.'}</p><hr>`;
    }

    function sectionBias() {
      const freq = formData.biasAuditFrequency;
      return heading(9,'Fairness & Bias Mitigation') + `
<p>High-risk AI systems undergo a documented Bias & Fairness Review prior to deployment.</p>
<p>Subsequent bias audits occur <strong>${freq}</strong>, with findings reported to the governance committee.</p>
<p>Any discriminatory outcomes trigger immediate remediation or rollback.</p><hr>`;
    }

    function lawSummary(law) {
      const map = {
        GDPR: {
          txt:'The EU General Data Protection Regulation sets strict rules on personal data processing across EU member states.',
          url:'https://gdpr.eu'
        },
        CCPA: {
          txt:'California Consumer Privacy Act grants consumers rights over their personal data and mandates transparency by businesses.',
          url:'https://oag.ca.gov/privacy/ccpa'
        },
        HIPAA: {
          txt:'The US Health Insurance Portability and Accountability Act protects medical information privacy.',
          url:'https://www.hhs.gov/hipaa/index.html'
        },
        'Quebec Law 25': {
          txt:'Quebec’s Law 25 imposes modernized privacy requirements on businesses handling personal data in Quebec.',
          url:'https://www.legisquebec.gouv.qc.ca/en/document/cs/P-39.1'
        },
        PIPEDA: {
          txt:'Canada’s PIPEDA governs how private-sector organizations collect, use, and disclose personal data in the course of commercial activities.',
          url:'https://www.priv.gc.ca/en/privacy-topics/privacy-laws-in-canada/the-personal-information-protection-and-electronic-documents-act-pipeda/'
        }
      };
      const entry = map[law];
      return entry ? `<li><strong>${law}:</strong> ${entry.txt} <a href="${entry.url}" target="_blank">[Learn more]</a></li>` : '';
    }

    function sectionCompliance() {
      const laws = formData.laws||[];
      if (!laws.length && !formData.customLaws && !(formData.exportControls||[]).length) return '';
      let items = laws.map(lawSummary).join('');
      if (formData.customLaws) items += `<li>${formData.customLaws}</li>`;
      const ex = (formData.exportControls||[]).map(e=>`<li>${e}</li>`).join('');
      if (formData.customExport) items += `<li>${formData.customExport}</li>`;
      return heading(10,'Compliance & Legal') + `
<ul>
  ${items}
  ${ex?'<li><strong>Export Controls:</strong></li><ul>'+ex+'</ul>':''}
  <li>This policy supplements our Info Security, Code of Conduct & IP policies.</li>
</ul><hr>`;
    }

    function sectionTransparency() {
      return heading(11,'Transparency & Explainability') + `
<p>${formData.publicDisclosure==='Yes'
  ? 'Policy and AI usage details are publicly available to maintain accountability.'
  : 'Policy is internal; no public disclosure.'}</p>
<p>${formData.explainability==='Yes'
  ? 'Employees must explain AI decisions in plain language upon request.'
  : 'No formal explainability requirement externally.'}</p><hr>`;
    }

    function sectionTraining() {
      return heading(12,'Training & Awareness') + `
<p>${formData.training==='Yes'
  ? 'Mandatory onboarding covering AI fundamentals, ethics, data privacy, and this policy.'
  : 'Training is recommended but not mandatory.'}</p>
<p>${formData.acknowledgment==='Yes'
  ? 'Employees must formally acknowledge the policy via HR portal.'
  : 'No formal acknowledgement required.'}</p><hr>`;
    }

    function sectionVendorContracts() {
      return heading(13,'Vendor & Contract Clauses') + `
<p>${formData.vendorClauses==='Yes'
  ? 'All third-party AI vendors must sign contract clauses covering security, privacy & ethics.'
  : 'No formal vendor clauses required.'}</p>
<p>${formData.customVendorClauses||''}</p><hr>`;
    }

    function sectionDataRetention() {
      const dr = formData.dataRetention;
      return heading(14,'Data Retention') + `
<p>AI training data, logs, and model artifacts are retained for <strong>${dr}</strong>.
${formData.customDataRetention||''}</p><hr>`;
    }

    function sectionLogging() {
      const en = formData.enableLogging?'Yes':'No';
      const lr = formData.logRetention;
      return heading(15,'Logging & Monitoring') + `
<p>Usage logging enabled: <strong>${en}</strong>.</p>
<p>Log retention period: <strong>${lr}</strong>. ${formData.customLogRetention||''}</p><hr>`;
    }

    function sectionRiskClass() {
      const rc = formData.riskClassification;
      return heading(16,'Risk Classification') + `
<p>AI systems are classified as <strong>${rc}</strong> risk. ${formData.customRiskClassification||''}</p><hr>`;
    }

    function sectionIncidents() {
      const parts = [];
      if (formData.incidentEmail) parts.push(`Email: <strong>${formData.incidentEmail}</strong>`);
      if (formData.incidentPhone) parts.push(`Phone: <strong>${formData.incidentPhone}</strong>`);
      if (formData.incidentSlack) parts.push(`Slack: <strong>${formData.incidentSlack}</strong>`);
      if (formData.incidentTeams) parts.push(`Teams: <strong>${formData.incidentTeams}</strong>`);
      return heading(17,'Incident Reporting & Response') + `
<p>Report incidents immediately via ${parts.join(', ')}.</p>
<ul>
  <li>Triage by Security & Governance lead.</li>
  <li>Remediation plan within 10 business days.</li>
  <li>Regulator/customer notifications per obligations.</li>
</ul><hr>`;
    }

    function sectionReview() {
      return heading(18,'Review & Updates') + `
<ul>
  <li>Frequency: <strong>${formData.reviewFrequency}</strong>.</li>
  <li>Ownership: <strong>${formData.responsibleTeam}</strong>.</li>
</ul><hr>`;
    }

    function sectionSignoff() {
      return heading(19,'Sign-off & Acknowledgment') + `
<p>All personnel must acknowledge this policy via HR portal within 14 days of publication & each revision.</p><hr>`;
    }

    function renderFinal() {
      let out = '';
      out += sectionIntro();
      out += sectionScope();
      out += sectionDefinitions();
      out += sectionTools();
      out += sectionPrivacy();
      out += sectionProhibited();
      out += sectionGovernance();
      out += sectionIP();
      out += sectionBias();
      out += sectionCompliance();
      out += sectionTransparency();
      out += sectionTraining();
      out += sectionVendorContracts();
      out += sectionDataRetention();
      out += sectionLogging();
      out += sectionRiskClass();
      out += sectionIncidents();
      out += sectionReview();
      out += sectionSignoff();
      out += `<p><em>Approved by: ______________________  Date: ___________  Version: 1.0</em></p>
              <p><em>Generated with AI Policy Builder. Review with legal & compliance teams. No liability assumed.</em></p>`;

      wizardDiv.innerHTML = `<h2>Preview & Copy</h2>
        <div class="policy-output">${out}</div>
        <button onclick="copyRichText()">Copy to Clipboard</button>`;
    }

    function copyRichText() {
      const div = document.querySelector('.policy-output');
      const range = document.createRange();
      range.selectNode(div);
      window.getSelection().removeAllRanges();
      window.getSelection().addRange(range);
      document.execCommand('copy');
      window.getSelection().removeAllRanges();
      alert('Policy copied to clipboard!');
    }

    // initialize
    renderStep();
  </script>
</body>
</html>
